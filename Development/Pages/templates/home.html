<!DOCTYPE html>
{% load static %}
<html lang="en">
  
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <link rel="stylesheet" href="{% static 'styles.css' %}" type="text/css"/>
        <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js" defer></script>
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js" defer></script>
        <script src="{% static 'secrets.js' %}" defer></script>
        <script src="{% static 'scripts.js' %}" defer></script>
    </head>

    <body>
    <div id ="app"> 
        <header id = "header" class ="header">
            <nav id ="navBtns" class= "flex">
                <input class = "searchBar" v-on:keyup.enter="searchKeyword" type = "text" v-model="searchTerm"></input>
                <a class = "navLink"  v-on:click="popularSearch">Trending Movies</a>
                <a class = "navLink" href = "#">TV Shows </a>
                <a class = "navLink" href = "#">Profile</a>
                {% if user.is_authenticated  == False%}
                <a class = "navLink" href = "accounts/login/">Login</a>
                <a class = "navLink" href = "accounts/signup">Signup</a>
                {% else %}
                <a class = "navLink" href = "accounts/logout/">Logout</a>
                <div class="sameLine">
                <img id = "navAvatar" src = {{user.avatar.url}}></img>
                <p id = "welcomeMessage">Hello, {{user}}!</p>
                </div>
                {% endif %}
            </nav>
            <button id ="navLogo" v-on:click="displayNavbar()">&#8801;</button>
        </header>
        <button class = "topBtn"  v-on:click="goTop(); showNavBar();">&#11014;</button>

        <main>
            <div id ="topBar">
                <article>
                    <div id = "navContent" class = "flex">
                        <button id = "leftBtn" v-on:click="carouselLeft()"><<</button>
                        <div id = "allMovies" class ="flex">
                            <div id ="movieContainer" class="movieContainer" v-for="(movie,index) in  currentCarousel">
                                <div class="row">
                                    <img  :src = movie.posterLink id= "moviePoster" v-on:click="movieDetail(index);"></img>
                                </div>
                            </div>
                        </div>
                        <button id = "rightBtn" v-on:click="carouselRight()">>></button>
                        <div id ="noMovies" class = "hide">
                            NO MOVIES TO DISPLAY!
                        </div>
                    </div>
                    <div>
                    <button id = "navHide" v-on:click="hideNavBar()">[[navArrow]]</button>
                    </div>
                </article><br>
            </div>

            <aside>
                <div id = "asideContainer" class ="asideIndentLarge hide" v-if="currentAside">
                    [[currentAside.title]]<br>
                    <img  :src = currentAside.posterLink id= "moviePoster" ></img><br>
                    [[currentAside.release_date]]<br>
                    <p class="movieOverview">[[currentAside.overview]]</p><br>
                        Available to stream from: <br><br>
                    <div class = "providerContainer" v-if= "currentAside.id">
                        <div v-for="(provider,index) in currentProviders">
                            <img :src=provider.logo_path alt= provider.provider_name></img>
                        </div>
                    </div>
                </div>
            </aside>

            <div id ="reviewOuter">
                <div class="sameLine">
                    <button id = "fillReview" class="btn"v-on:click="fillUserImgs(); ">Reviews</button>
                    <button id = "hideReview" class="btn hide" v-on:click="hideReviews();">Reviews</button>
                    <button id = "inputReview" class="btn" v-on:click="showInput();">Write Review</button>
                    <button id = "castBtn" class="btn" v-on:click="displayCast();">Cast</button>
                    <button id = "crewBtn" class="btn" v-on:click="displayCrew();">Crew</button>
                    <button id = "trailersBtn" class="btn" v-on:click="displayTrailers();">Trailers</button>
                    <button id = "hideInputBtn" class ="btn hide" v-on:click="showInput();">[[reviewMinimize]]</button>
                </div>
                <div id = "reviewInput" class= "hide">
                    <p id = "bodyTag">Review Body:</p>
                    <textarea id = "inputText" v-model = "reviewText" type = "text" ></textarea><br>
                    Number Rating:<br>
                    <div class ="sameLine">
                        <button id= "numLeft" v-on:click="decRating"><<</button> 
                        <button id = "inputNum"> [[reviewNum]]</button>
                        <button id= "numRight" v-on:click="incRating">>></button> 
                    </div><br>
                    [[ratingNumText]]<br>
                    <button id ="inputSubmit" v-on:click="submitReview">Submit</button>
                </div>
            </div>

            <div id="myReviewContainer" class="hide">
                    <div v-if="currentUserImgs" v-for="(review,index) in currentReviews" class = "reviewContainer">
                        <img id="avatarImg" :src= (currentUserImgs[review.author]) ></img>
                        Author: <a :href = getProfileLink(review.author)>[[ (currentUserNames[review.author]) ]] </a><br> 
                        Rating: [[review.numRating]]<br>
                        Review: [[review.textBody]]<br> 
                        <button id= "upvote" v-on:click.once= "upVote(review.pk, review.upVotes, review.downVotes, review.myVotedIds, index)"> &#128077; </button>[[review.upVotes]]
                        <button id= "downvote" v-on:click.once= "downVote(review.pk, review.upVotes, review.downVotes, review.myVotedIds, index)"> &#128078; </button>[[review.downVotes]]
                        <button v-if= "review.author == currentUser" id= "editBtn" v-on:click = "editReview()">&#9998;</button>
                    </div>
            </div>

            <div id = "castContainer" class ="hide">
                <div id = "innerCast" v-if="currentCast" v-for="cast in currentCast">
                    Character: [[cast.character]]<br>
                    Real Name: [[cast.name]]<br>
                    Role: [[cast.known_for_department]]<br>
                    <img id="castImg" :src= cast.profile_path onError="this.onerror=null; this.src='media/default.jpg'"></img><br>
                </div>
            </div>
            <div id = "crewContainer" class ="hide">
                <div id = "innerCrew" v-if="currentCrew" v-for="crew in currentCrew">
                    Real Name: [[crew.name]]<br>
                    Role: [[crew.known_for_department]]<br>
                    <img id="crewImg" :src= crew.profile_path onError="this.onerror=null; this.src='media/default.jpg'"></img><br>
                </div>
            </div>
            <div id = "trailerContainer" class="hide">
                <div id = "innerTrailer" v-if="currentAside.videos" v-for="video in currentAside.videos">
                    Type:[[video.type]]<br>
                    Website:[[video.site]]<br>
                    Title:[[video.name]]<br>
                    <a :href="video.key">go to video</a><br>
                </div>
            </div>
        </main>

        <footer id="footer">
            <nav>
            </nav>
            <nav>
            </nav>
        </footer>

    </div>
    </body>
            <div id="currentUserId" class="hidden">{{user.id}}</div>
</html>
